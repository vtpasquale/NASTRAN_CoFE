<!DOCTYPE html>
<html>
<head>
  <title>Constraints and Partitioning</title>

  <script type="text/javascript" src="headerCSI.js"></script>
  <link rel="stylesheet" type="text/css" href="mystyle.css">
  <script type="text/javascript" src="mathJaxCSI.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
</head>
<body>

<script type="text/javascript" src="navbarCSI.js"></script>

<div class="container">

<h1>Constraints and Partitioning</h1>

<h2>Content Source</h2>

<p>
This content on this page is directly excerpted from <i>The NASTRAN Theoretical Manual</i> [1] with some elaboration by Anthony Ricciardi.  
</p>

<h2>Multipoint Constraints (Rigid Elements)</h2>

<p>
Multipoint constraints and rigid elements are used to constrain one or more degrees of freedom to be equal to linear combinations of the values of other degrees of freedom. In the former case, the user must provide explicitly the coefficients of the constraint equations while, in the latter case, he needs to provide only the connection data; the program internally generates the required coefficients. The mathematical details of the generation of these coefficients are discussed in Section 3.5.6.
</p>

<p>
The constraint equations resulting from the use of multipoint constraints and rigid elements together can be expressed in the form
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>g</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>g</mi></mrow></msub><mo>=</mo><mn>0</mn>
</math></p>

<p>
where the coefficients are either supplied explicitly by the user (in the form of multipoint constraint equations) or are internally generated by the program (in the case of rigid elements). The user also specifies the degrees of freedom that are made dependent by the equations of multipoint constraint and by the rigid elements, so that the <math><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>g</mi></mrow></msub></math>
vector may immediately be partitioned into two subsets, 
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>g</mi></mrow></msub><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
where the set, $\boldsymbol{u}_m$, is the set of dependent degrees of freedom. The matrix of constraint coefficients is similarly partitioned
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>g</mi></mrow></msub><mo>=</mo><mfenced open="[" close="]" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>n</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
so that the equation becomes
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><mn>0</mn>
</math></p>

<p>
$\boldsymbol{R}_m$ is a nonsingular matrix.  The constraint matrix can, therefore, be formed as
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><mo>-</mo><msubsup><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>m</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">R</mi></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
so the previous equation  may be stated as
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
Prior to the imposition of constraints, the structural problem may be written as
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>g</mi><mi>g</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>g</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">P</mi></mrow><mrow><mi>g</mi></mrow></msub>
</math></p>

<p>
or, partitioning in terms of the coordinate sets, $\boldsymbol{u}_n$ and $\boldsymbol{u}_m$
</p>

<p align="center"><math>
<mfenced open="[" close="]" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
Bars over symbols are used to designate arrays that are replaced in the reduction process.  The addition of constraints to the structure requires that the forces of constraint be added to the equilibrium equations. 
</p>

<p align="center"><math>
<msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p align="center"><math>
<msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>-</mo><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub>
</math></p>

<p>
where $\boldsymbol{q}_m^m$ is the vector of constraint forces on <math><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub></math>.  Thus, writing the equilibrium and constraint equations (<math><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><mn>0</mn></math>) together in partitioned form,
</p>

<p align="center"><math>
<mfenced open="[" close="]" separators="|"><mrow><mtable><mtr><mtd><mtable><mtr><mtd><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mo>|</mo></mtd><mtd><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr></mtable></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><mo>-</mo><mi mathvariant="bold-italic">I</mi></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mo>|</mo></mtd><mtd><mo>-</mo><mi mathvariant="bold-italic">I</mi></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><mo>|</mo></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
Solving for $\boldsymbol{p}_m$ in the second matrix equation
</p>

<p align="center"><math>
<msubsup><mrow><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub>
</math></p>

<p>
and substitute in the first matrix equation 
</p>

<p align="center"><math>
<msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mfenced separators="|"><mrow><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></mfenced><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
distribute
</p>

<p align="center"><math>
<msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>+</mo><msubsup><mrow><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>-</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
substitute $\boldsymbol{u}_m = \boldsymbol{G}_m \boldsymbol{u}_n$
</p>

<p align="center"><math>
<msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msubsup><mrow><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>-</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
and rearrange
</p>

<p align="center"><math>
<mfenced open="[" close="]" separators="|"><mrow><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">K</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>+</mo><msubsup><mrow><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></mfenced><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub>
</math></p>

<p>
or 
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>n</mi></mrow></msub>
</math></p>

<p>
where $\boldsymbol{K}_{nn}$ and $\boldsymbol{p}_n$ (no <span style="text-decoration:
  overline">bars</span>) are known
</p>

<p>
\begin{equation}
\label{eq1}
\boldsymbol{K}_{nn} = \bar{\boldsymbol{K}}_{nn} + \boldsymbol{K}_{nm} \boldsymbol{G}_m
\boldsymbol{G}^T_m \boldsymbol{K}_{nm}^T + \boldsymbol{G}^T_m \boldsymbol{K}_{mm}^T \boldsymbol{G}_m
\end{equation}
\begin{equation}
\label{eq2}
\boldsymbol{p}_n = \bar{\boldsymbol{p}}_n + \boldsymbol{G}^T_m \boldsymbol{p}_m
\end{equation}
</p>

<p>
The initial partition of $\boldsymbol{K}_{gg}$ and the associated operations are performed by appropriate modules of the program. The constraint matrix, $\boldsymbol{G}_m$, is used in structural matrix reduction (Equation (\ref{eq1})), load vector reduction (Equation (\ref{eq2}), and data recovery ($\boldsymbol{u}_m=\boldsymbol{G}_m \boldsymbol{u}_n$). It is saved for these purposes.  The other structural matrices (i.e., $\boldsymbol{M}_{gg}$) are transformed by formulas that are identical in form to Equation (\ref{eq1}).
</p>

<p>
The vector of constraint forces $\boldsymbol{q}_m^m$ on $\boldsymbol{u}_m$ is obtained from the middle row of the partitioned matrix equation 
</p>

<p align="center"><math>
<msubsup><mrow><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>m</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>m</mi></mrow></msub>
</math></p>

<p>
Let $\boldsymbol{q}_n^m$  be the vector of constraint forces on $\boldsymbol{u}_n$. Then it is clear that
</p>

<p align="center"><math>
<msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><mo>-</mo><msubsup><mrow><mi mathvariant="bold-italic">G</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup>
</math></p>

<p>
So, the resultant forces of constraint due to multipoint constraints and rigid elements are therefore given by
</p>

<p align="center"><math>
<msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>g</mi></mrow><mrow><mi>m</mi></mrow></msubsup><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>m</mi></mrow></msubsup></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>m</mi></mrow><mrow><mi>m</mi></mrow></msubsup></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>

<h2>Single-Point Constraints (Boundary Conditions)</h2>

<p>
Single point constraints are applied to the set, $\boldsymbol{u}_s$ , in the form
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">y</mi></mrow><mrow><mi>s</mi></mrow></msub>
</math></p>

<p>
where $\boldsymbol{y}_s$ is a vector of enforced deformations, any or all of whose elements may be zero. The set, $\boldsymbol{u}_n$, is partitioned into $\boldsymbol{u}_s$ and $\boldsymbol{u}_f$ (the free or unconstrained set).
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>n</mi></mrow></msub><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
The stiffness matrix, $\boldsymbol{K}_{nn}$, is similarly partitioned
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><mo>=</mo><mfenced open="[" close="]" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>f</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow><mrow><mi>T</mi></mrow></msubsup></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
The complete structural equations including the single point forces of constraint, $\boldsymbol{u}_q$, may be written in partitioned matrix form as
</p>

<p align="center"><math>
<mfenced open="[" close="]" separators="|"><mrow><mtable><mtr><mtd><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>f</mi></mrow></msub></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mo>|</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr></mtable></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow><mrow><mi>T</mi></mrow></msubsup></mtd><mtd><mo>|</mo></mtd><mtd><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo></mtd><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>|</mo></mtd><mtd><mo>-</mo><mi mathvariant="bold-italic">I</mi></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mo>|</mo></mtd><mtd><mo>-</mo><mi mathvariant="bold-italic">I</mi></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><mo>-</mo></mtd></mtr><mtr><mtd><mo>|</mo></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>s</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced><mo>=</mo><mfenced open="{" close="}" separators="|"><mrow><mtable><mtr><mtd><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>f</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><mo>-</mo><mo>-</mo></mtd></mtr><mtr><mtd><msub><mrow><mi mathvariant="bold-italic">y</mi></mrow><mrow><mi>s</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable></mrow></mfenced>
</math></p>

<p>
Using simple algebra
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>f</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>f</mi></mrow></msub>
</math></p>

<p>
Substituting $\boldsymbol{u}_s=\boldsymbol{y}_s$
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>f</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub><mo>=</mo><msub><mrow><mover accent="true"><mrow><mi mathvariant="bold-italic">p</mi></mrow><mo>-</mo></mover></mrow><mrow><mi>f</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">y</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>f</mi></mrow></msub>
</math></p>

<p>
or 
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>f</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>f</mi></mrow></msub>
</math></p>

<p>
Finally, constraint forces are recovered by means of the middle row of the partitioned equation
</p>

<p align="center"><math>
<msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>s</mi></mrow></msub>
</math></p>

<p>
or 
</p>

<p align="center"><math>
<msub><mrow><mi mathvariant="bold-italic">q</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>=</mo><msubsup><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>f</mi><mi>s</mi></mrow><mrow><mi>T</mi></mrow></msubsup><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>f</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold-italic">K</mi></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><msub><mrow><mi mathvariant="bold-italic">u</mi></mrow><mrow><mi>s</mi></mrow></msub><mo>-</mo><msub><mrow><mi mathvariant="bold-italic">p</mi></mrow><mrow><mi>s</mi></mrow></msub>
</math></p>

<p>
Thus all three of the distinct partitions of $\boldsymbol{K}_{nn}$ (i.e., $\boldsymbol{K}_{ff}$, $\boldsymbol{K}_{fs}$ and $\boldsymbol{K}_{ss}$) are needed in subsequent calculations, and are placed in auxiliary storage. For the other structural matrices (e.g., $\boldsymbol{M}_{nn}$) only the $ff$ partitions are saved. The assumption is made, implicitly, that the effects of the other structural matrices on the single point forces of constraint may be ignored.
</p>

<p>
Nonzero single-point constraints are not supported in CoFE.  Parameters $\boldsymbol{u}_s=\boldsymbol{y}_s=0$ for all cases.  This is a minor simplification of the equations.  It would not be prohibitively difficult to add nonzero single-point constraints to CoFE.  
</p>


<h2>Reference</h2>
<ol>
<li>
<i>The NASTRAN Theoretical Manual.</i> <crn>NASA-SP-221(06)</crn>. January 1981.  
</li>
</ol>

</div>

</body>
</html>